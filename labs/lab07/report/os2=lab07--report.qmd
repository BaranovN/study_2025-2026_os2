---
# Preamble

## Author
author:
  name: Баранов Никита Дмитриевич
## Title
title: "Отчёт о лабораторной работе"
subtitle: "Лабораторная работа 7. Управление журналами операционной системы"
license: "CC BY"
## Generic options
lang: ru-RU
number-sections: true
toc: true
toc-title: "Содержание"
toc-depth: 2
## Crossref customization
crossref:
  lof-title: "Список иллюстраций"
  lot-title: "Список таблиц"
  lol-title: "Листинги"
## Bibliography
bibliography:
  - bib/cite.bib
csl: _resources/csl/gost-r-7-0-5-2008-numeric.csl
## Formats
format:
### Pdf output format
  pdf:
    toc: true
    number-sections: true
    colorlinks: false
    toc-depth: 2
    lof: true # List of figures
    lot: true # List of tables
#### Document
    documentclass: scrreprt
    papersize: a4
    fontsize: 12pt
    linestretch: 1.5
#### Language
    babel-lang: russian
    babel-otherlangs: english
#### Biblatex
    cite-method: biblatex
    biblio-style: gost-numeric
    biblatexoptions:
      - backend=biber
      - langhook=extras
      - autolang=other*
#### Misc options
    csquotes: true
    indent: true
    header-includes: |
      \usepackage{indentfirst}
      \usepackage{float}
      \floatplacement{figure}{H}
### Docx output format
  docx:
    toc: true
    number-sections: true
    toc-depth: 2
---

# Цель работы

Получить навыки работы с журналами мониторинга различных событий в системе.

# Задание

1. Продемонстрируйте навыки работы с журналом мониторинга событий в реальном
времени (см. раздел 7.4.1).
2. Продемонстрируйте навыки создания и настройки отдельного файла конфигурации
мониторинга отслеживания событий веб-службы (см. раздел 7.4.2).
3. Продемонстрируйте навыки работы с journalctl (см. раздел 7.4.3).
4. Продемонстрируйте навыки работы с journald (см. раздел 7.4.4).

# Выполнение лабораторной работы

## Мониторинг системных событий

Запускаем три вкладки терминала и получаем полномочия администратора (рис. [-@fig:001]).

![Получение прав администратора](image/1.png){#fig:001 width=70%}

На второй вкладке запускаем мониторинг системных событий в реальном времени (рис. [-@fig:002]).

![Мониторинг /var/log/messages](image/2.png){#fig:002 width=70%}

В третьей вкладке пытаемся получить полномочия администратора с неправильным паролем и видим сообщение об ошибке в логах (рис. [-@fig:003]).

![Неудачная попытка su и использование logger](image/3.png){#fig:003 width=70%}

Просматриваем сообщения безопасности в /var/log/secure (рис. [-@fig:002]).

![Просмотр логов безопасности](image/2.png){#fig:002 width=70%}

## Настройка регистрации сообщений веб-службы

Устанавливаем и запускаем Apache HTTP server (рис. [-@fig:004], [-@fig:005]).

![Установка Apache](image/4.png){#fig:004 width=70%}
![Запуск и включение Apache](image/5.png){#fig:005 width=70%}

Просматриваем журнал ошибок веб-службы (рис. [-@fig:006]).

![Просмотр error_log Apache](image/6.png){#fig:006 width=70%}

Настраиваем Apache для использования syslog, добавляя строку в конфигурационный файл (рис. [-@fig:007]).

![Настройка ErrorLog в httpd.conf](image/7.png){#fig:007 width=70%}

Создаем файл конфигурации для rsyslog и настраиваем перенаправление логов (рис. [-@fig:008], [-@fig:009]).

![Создание httpd.conf для rsyslog](image/8.png){#fig:008 width=70%}
![Настройка правил для local1](image/9.png){#fig:009 width=70%}

Перезапускаем службы и проверяем работу (рис. [-@fig:010]).

![Перезапуск служб](image/10.png){#fig:010 width=70%}

## Настройка мониторинга отладочной информации

Создаем конфигурационный файл для отладочных сообщений (рис. [-@fig:011]).

![Создание debug.conf](image/11.png){#fig:011 width=70%}

Перезапускаем rsyslog и тестируем отправку отладочного сообщения (рис. [-@fig:012]).

![Тестирование отладочных сообщений](image/12.png){#fig:012 width=70%}

## Работа с journalctl

Просматриваем различные варианты использования journalctl (рис. [-@fig:013], [-@fig:014], [-@fig:015], [-@fig:016], [-@fig:017], [-@fig:018], [-@fig:019]).

![Просмотр журнала systemd](image/13.png){#fig:013 width=70%}
![Поля journalctl](image/14.png){#fig:014 width=70%}
![Фильтрация по UID](image/15.png){#fig:015 width=70%}
![Просмотр последних записей](image/16.png){#fig:016 width=70%}
![Просмотр ошибок](image/17.png){#fig:017 width=70%}
![Фильтрация по времени](image/18.png){#fig:018 width=70%}
![Подробный вывод и фильтрация по службе](image/19.png){#fig:019 width=70%}

## Настройка постоянного хранения журналов systemd

Создаем каталог для постоянного хранения журналов и настраиваем права доступа (рис. [-@fig:020]).

![Настройка постоянного хранения журналов](image/20.png){#fig:020 width=70%}

Применяем изменения и проверяем журнал с момента последней загрузки системы (рис. [-@fig:020]).

![Проверка журнала после настройки](image/20.png){#fig:020 width=70%}

# Выводы

В ходе лабораторной работы были получены навыки работы с системными журналами операционной системы. Настроена регистрация сообщений веб-службы Apache через syslog, созданы правила для мониторинга отладочной информации и освоена работа с утилитой journalctl для просмотра и анализа журналов systemd. Также была выполнена настройка постоянного хранения журналов systemd в каталоге /var/log/journal, что позволяет сохранять записи журнала между перезагрузками системы.

# Список литературы{.unnumbered}

::: {#refs}
:::
